{% extends 'layouts/layout_page.html' %} {% from 'macros/_button.html'
import Button %} {% from 'macros/_proveedor.html' import addProv,txtArea %}
{% block title %} Login - Cookies and Dreams{% endblock %} {% block
content %}
<style>
	.flash-messages {
		position: fixed;
		top: 0;
		left: 50%;
		transform: translateX(-50%);
		z-index: 1000;
		width: 100%;
		max-width: 600px;
		padding: 10px;
		color: #fff;
		text-align: center;
	}
	input[type='text'],
	input[type='email'],
	input[type='password'],
	input[type='number'],
	input[type='date'],
	input[type='time'],
	input[type='datetime-local'],
	select,
	input[type='search'] {
		background-color: white !important;
	}
</style>
<section class="w-full h-screen flex flex-col">
    <!-- Flash meesage -->
    <div class="flash-messages">
        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %} {% for category, message in messages %}
        <div class="alert alert-{{ category }}">{{ message }}</div>
        {% endfor %} {% endif %} {% endwith %}
    </div>

    <section
        class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 p-4 overflow-y-auto">
        <!-- Button Dialog -->
        <div class="fixed top-4 right-4 float-right">
            <button class="btn btn-primary" id="btnAddProvider">
                Agregar Proveedor
            </button>
        </div>

        <!-- Form Add -->
        <form novalidate action="{{ url_for('proveedores.new_provider') }}"
            method="POST">
            <section class="text-black">
                <dialog id="addProvider" class="dialog">
                    <div class="dialog-content">
                        <input
                            type="hidden"
                            name="csrf_token"
                            value="{{ csrf_token() }}" />
                        <div class="form-group mt-3">
                            {{ addProv("Nombre de empresa", "",
                            "nombre_empresa","nombre_empresa") }}
                        </div>
                        <div class="form-group mt-3">
                            {{ addProv("Dirección de empresa", "",
                            "direccion_empresa","direccion_empresa") }}
                        </div>
                        <div class="form-group mt-3">
                            {{ addProv("Teléfono de empresa", "",
                            "telefono_empresa", "telefono_empresa") }}
                        </div>
                        <div class="form-group mt-3">
                            {{ addProv("Persona atendió", "",
                            "nombre_encargado", "nombre_encargado")
                            }}
                        </div>
                        <div class="form-group mt-3">
                            {{ txtArea("Productos", "", "productos","productos")
                            }}
                        </div>
                        <div class="form-group mt-3">
                            <button type="submit"
                                class="btn btn-primary">Guardar</button>
                            <button type="button" class="btn btn-secondary"
                                id="btnCloseProvider">Cerrar</button>
                        </div>
                    </div>
                </dialog>
            </section>
        </form>

    </section>
    <!-- Table -->
    <table class="table-auto">
        <thead>
            <tr>
                <th class="px-4 py-2">Nombre de empresa</th>
                <th class="px-4 py-2">Dirección de empresa</th>
                <th class="px-4 py-2">Teléfono de empresa</th>
                <th class="px-4 py-2">Persona atendió</th>
                <th class="px-4 py-2">Productos</th>
                <th class="px-4 py-2">Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% for provider in proveedores %}
            <tr>
                <td class="border px-4 py-2">{{ provider.nombre_empresa }}</td>
                <td class="border px-4 py-2">{{ provider.direccion_empresa
                    }}</td>
                <td class="border px-4 py-2">{{ provider.telefono_empresa
                    }}</td>
                <td class="border px-4 py-2">{{ provider.nombre_encargado
                    }}</td>
                <td class="border px-4 py-2">{{ provider.productos }}</td>
                <td class="border px-4 py-2">
                    <a
                        href="{{ url_for('proveedores.ed_provider', id=provider.id) }}"
                        class="btn btn-primary">Editar</a>
                    <a
                        href="{{ url_for('proveedores.del_provider', id=provider.id) }}"
                        class="btn btn-danger">Eliminar</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

</section>

<!-- Javascript -->
<script>
    const flashMessage = document.querySelector('.flash-messages');
    if (flashMessage) {
        setTimeout(() => {
            flashMessage.remove();
        }, 5000);
    }

    const btnAddProvider = document.getElementById('btnAddProvider');
    const addProvider = document.getElementById('addProvider');
    const btnCloseProvider = document.getElementById('btnCloseProvider');

    btnAddProvider.addEventListener('click', () => {
        addProvider.showModal();
    });

    btnCloseProvider.addEventListener('click', () => {
        addProvider.close();
    });
</script>
{% endblock %}
